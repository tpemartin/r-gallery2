import{g as U,a as V,s as J,T as g,b as K,r as i,u as Y,_ as q,j as e,d as R,e as z,f as H,S as b,B as f,c as X,R as Q}from"./Stack-86ff4452.js";import{L as W,a as w}from"./axios-03d940e2.js";import{D as S,a as F,b as _,c as v,B as x,T as C,C as k,d as Z,e as ee,u as te,g as se,f as ne,P as G,h as oe,A as re,i as D,j as ae,F as ie,k as le,l as ce,G as de}from"./Backup-45e88d61.js";import{A as E,d as ue,b as je,P as xe,a as me}from"./GitHub-dc70a66f.js";import{F as ge,a as he,R as pe,b as fe,c as be}from"./RadioGroup-7fdb132a.js";import{F as A,R as we,d as Ce,a as ye}from"./Close-1b73098c.js";import{G as P}from"./Grid2-d5300dc2.js";function Se(t){return U("MuiDialogContentText",t)}V("MuiDialogContentText",["root"]);const Fe=["children","className"],_e=t=>{const{classes:s}=t,o=H({root:["root"]},Se,s);return R({},s,o)},ve=J(g,{shouldForwardProp:t=>K(t)||t==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(t,s)=>s.root})({}),ke=i.forwardRef(function(s,n){const o=Y({props:s,name:"MuiDialogContentText"}),{className:l}=o,r=q(o,Fe),a=_e(r);return e.jsx(ve,R({component:"p",variant:"body1",color:"text.secondary",ref:n,ownerState:r,className:z(a.root,l)},o,{classes:a}))}),B=ke;function Te({number:t,title:s,subtitle:n,group:o}){return e.jsx(e.Fragment,{children:e.jsxs(b,{direction:"row",spacing:2,sx:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Oe,{groupNumber:t}),e.jsx(Ge,{title:s,subtitle:n}),e.jsx(De,{group:o})]})})}function Oe({groupNumber:t=1}){return e.jsx(e.Fragment,{children:e.jsx(E,{sx:{bgcolor:ue[500]},children:t})})}function Ge({title:t="Title",subtitle:s="Subtitle"}){return e.jsx(e.Fragment,{children:e.jsxs(b,{direction:"column",spacing:2,className:"card-title",children:[e.jsx(g,{variant:"h6",children:t}),e.jsx(g,{variant:"subtitle1",children:s})]})})}function De({group:t}){return e.jsx(e.Fragment,{children:e.jsx(g,{children:t})})}function Re({link:t}){return e.jsx(e.Fragment,{children:e.jsx(b,{direction:"column",spacing:2,sx:{alignItems:"center"},children:e.jsx(Ee,{link:t})})})}function Ee({link:t}){let s;return t.includes("you")?s=`https://www.youtube.com/embed/${Ae(t)}`:t.includes("vimeo")&&(s=`https://player.vimeo.com/video/${Pe(t)}?h=7c051b9510`),e.jsx(e.Fragment,{children:e.jsx("iframe",{src:s,width:"100%",height:200,frameBorder:0,allow:"autoplay; fullscreen",allowFullScreen:!0})})}function Ae(t){return t.match(new RegExp("(?<=https:\\/\\/youtu\\.be\\/)[^/]+"))[0]}function Pe(t){return t.match(new RegExp("(?<=https:\\/\\/vimeo\\.com\\/)[^/]+"))[0]}function Be({description:t}){return e.jsx(e.Fragment,{children:e.jsx(f,{sx:{overflow:"hidden",height:"300px",overflowY:"scroll"},children:e.jsx(g,{variant:"body1",children:t})})})}function Ie({github_link:t,group:s,assessment:n}){console.log(n&&n.group&&n.group===s);const o=n&&n.group&&n.group===s?e.jsx(e.Fragment,{}):e.jsx(Le,{group:s,assessment:n});return e.jsx(e.Fragment,{children:e.jsxs(b,{direction:"row",spacing:2,sx:{justifyContent:"space-between"},children:[e.jsx(W,{href:t,target:"_blank",rel:"noopener noreferrer",children:e.jsx(je,{})}),o]})})}function Le({group:t,assessment:s}){console.log(s);const[n,o]=i.useState(!1),[l,r]=i.useState(s&&s.projects&&s.projects[t]?s.projects[t]:null);console.log(l);const a=()=>{o(u=>!u)};i.useEffect(()=>{s&&s.projects&&s.projects[t]&&r(s&&s.projects&&s.projects[t])},[s,t]);const c=s&&s.projects&&s.projects[t]===t?e.jsx(e.Fragment,{}):e.jsx(A,{in:n,timeout:300,children:e.jsx(we,{name:"project-rating",value:l,max:5,disabled:s&&s.submit||s&&s.group===t,onChange:(u,j)=>{r(j),window.assessment.projects&&(window.assessment.projects[t]=j)}})});return e.jsxs(e.Fragment,{children:[e.jsx(f,{children:c}),e.jsx(Ne,{ratingOpen:n,onClick:a})]})}function Ne({ratingOpen:t=!1,onClick:s}){const n=t?e.jsx(Ce,{onClick:s}):e.jsx(ye,{onClick:s});return e.jsx(e.Fragment,{children:n})}function $e({project:t,number:s,group:n,assessment:o}){return console.log(o),e.jsx(e.Fragment,{children:e.jsx(xe,{elevation:3,sx:{p:3},children:e.jsxs(b,{direction:"column",spacing:2,children:[e.jsx(Te,{number:s,title:t.Title,subtitle:null,group:n}),e.jsx(Re,{link:t["Video link"]}),e.jsx(Be,{description:t.Description}),e.jsx(Ie,{github_link:t["Github link"],group:n,assessment:o})]})})})}function Me({project:t,number:s,group:n,assessment:o}){return e.jsx(e.Fragment,{children:e.jsx(P,{xs:12,sm:6,md:4,xl:3,children:e.jsx($e,{project:t,number:s,group:n,assessment:o})})})}const Ue="https://script.google.com/macros/s/AKfycbyzyEoS3EBRxhYuIfYGD4Uz-lPw_VX-0tlFMgXbQAciE2hYdrPZlYN-sOKVwyXqHAb46w/exec",T={uri:Ue},Ve=T.uri;console.log(T);function Je(t){const s=t.shift();function n(l){const r=Object();return l.forEach((a,c)=>{r[s[c]]=a}),r}return t.map(l=>n(l))}async function Ke(){try{const t=await w.get(Ve);return Je(t.data)}catch(t){console.log(t)}}function Ye({assessment:t}){const s=localStorage.getItem("dataObjects"),[n,o]=i.useState(s&&s!=="undefined"?JSON.parse(s):null),l=n?e.jsx(P,{container:!0,spacing:2,children:n.map((r,a)=>{const c=r.Group;return e.jsx(Me,{project:r,number:a+1,group:c,assessment:t},c)})}):e.jsx("div",{children:" loading...."});return i.useEffect(()=>{Ke().then(r=>{o(r),console.log(r),window.assessment_project_template=Object(),r.map(a=>a.Group).forEach(a=>window.assessment_project_template[a]=null),localStorage.setItem("dataObjects",JSON.stringify(r))})},[]),e.jsx(e.Fragment,{children:l})}window.axios=w;const I=T.uri;async function qe(t){const s=JSON.stringify({accessToken:t});return await w.post(I,s)}async function L(t,s,n=!1){const o=JSON.stringify({accessToken:t,assessment:s});return await w.post(I,o,{params:{submit:n}})}function ze({children:t,disabled:s=!1}){const[n,o]=i.useState(!1),l=()=>{o(!0)},r=()=>{o(!1)},a=e.jsx(He,{onClick:l,open:n,disabled:s}),c=i.useRef(null);return i.useEffect(()=>{if(n){const{current:u}=c;u!==null&&u.focus()}},[n]),e.jsxs(i.Fragment,{children:[a,e.jsxs(S,{open:n,onClose:r,scroll:"paper","aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",children:[e.jsx(F,{id:"scroll-dialog-title",children:"組員互評"}),e.jsx(_,{dividers:!0,children:t}),e.jsx(v,{children:e.jsx(x,{onClick:r,children:"OK"})})]})]})}function He({onClick:t,open:s,disabled:n=!1}){return e.jsx(e.Fragment,{children:e.jsx(C,{title:"組員互評",children:e.jsx(x,{color:"inherit",onClick:t,open:s,disabled:n,children:e.jsx(me,{})})})})}function Xe({disabled:t}){const[s,n]=i.useState(!1),[o,l]=i.useState(!1),[r,a]=i.useState("評分儲存成功"),c=()=>{l(!0),L(window.accessToken,window.assessment).then(h=>{console.log(h),l(!1),h.status===200?a("評分儲存成功"):a("儲存失敗，請重新儲存"),n(!0)})},u=()=>{n(!1)},j=o?e.jsx(k,{color:"inherit"}):e.jsx(C,{title:"儲存",children:e.jsx(x,{color:"inherit",onClick:c,disabled:t,children:e.jsx(Z,{})})});return e.jsxs(i.Fragment,{children:[j,e.jsxs(S,{open:s,onClose:u,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(F,{id:"alert-dialog-title",children:"執行結果"}),e.jsx(_,{children:e.jsx(B,{id:"alert-dialog-description",children:r})}),e.jsx(v,{children:e.jsx(x,{onClick:u,children:"OK"})})]})]})}function Qe({setHasSubmit:t,disabled:s}){const[n,o]=i.useState(!1),[l,r]=i.useState(!1),[a,c]=i.useState("評分儲存成功"),[u,j]=i.useState(!0),h=()=>{j(!0),c(JSON.stringify(window.assessment)),o(!0)},y=()=>{j(!1),o(!1),r(!0),window.assessment.submit=!0,L(window.accessToken,window.assessment,!0).then(O=>{console.log(O),r(!1),O.status===200?(c("評分上傳成功"),t(!0)):(c("上傳失敗，請重新上傳"),window.assessment.submit=!1,t(!1)),o(!0)})},m=()=>{o(!1)},p=l?e.jsx(k,{color:"inherit"}):e.jsx(C,{title:"儲存",children:e.jsx(x,{color:"inherit",onClick:h,disabled:s,children:e.jsx(ee,{})})}),d=u?"請確認評分":"執行結果",M=u?e.jsxs(e.Fragment,{children:[e.jsx(x,{onClick:y,children:"確認上傳"}),e.jsx(x,{onClick:m,children:"放棄"})]}):e.jsx(e.Fragment,{children:e.jsx(x,{onClick:m,children:"OK"})});return e.jsxs(i.Fragment,{children:[p,e.jsxs(S,{open:n,onClose:m,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(F,{id:"alert-dialog-title",children:d}),e.jsx(_,{children:e.jsx(B,{id:"alert-dialog-description",children:a})}),e.jsx(v,{children:M})]})]})}function We({membersAssessment:t}){console.log(t),console.log(window.assessment&&window.assessment.submit);const[s,n]=i.useState(window.assessment&&window.assessment.submit);return e.jsxs(e.Fragment,{children:[e.jsx(Qe,{setHasSubmit:n,disabled:s}),e.jsx(Xe,{disabled:s}),e.jsx(Ze,{membersAssessment:t,disabled:s})]})}function Ze({membersAssessment:t,disabled:s=!1}){console.log(t);const n=Object.keys(t);console.log(n);const o=e.jsx(e.Fragment,{children:n.map((l,r)=>e.jsx(et,{member:l},r))});return e.jsx(ze,{children:e.jsx(ge,{disabled:s,children:o})})}function et({member:t}){const s=e.jsx(tt,{member:t});return e.jsxs(e.Fragment,{children:[e.jsx(he,{id:t,children:t}),s]})}function tt({member:t}){const[s,n]=i.useState(window.assessment.members[t]),o=(a,c)=>{window.assessment.members[t]=c,n(c)},r=Array.from({length:6},(a,c)=>c).map((a,c)=>e.jsx(st,{value:a},c));return e.jsx(e.Fragment,{children:e.jsx(pe,{row:!0,"aria-labelledby":t,name:"position",defaultValue:"top",value:s,onChange:o,children:r})})}function st({value:t}){return e.jsx(e.Fragment,{children:e.jsx(fe,{value:""+t,control:e.jsx(be,{}),label:""+t,labelPlacement:"top"})})}function nt({setAssessment:t}){const[s,n]=i.useState(!1),[o,l]=i.useState(null),[r,a]=i.useState(null),[c,u]=i.useState(!1),j=te({onSuccess:p=>{console.log(p),window.accessToken=p.access_token,qe(p.access_token).then(d=>{console.log(d),d.status===200&&(n(!0),d.data?(window.assessment.user=d.data.user,window.assessment.group=d.data.group,window.assessment.members=d.data.members,window.assessment.projects=d.data.assessment.projects?d.data.assessment.projects:window.assessment_project_template,l(d.data),a(!0),d.data.assessment&&(console.log(d.data.assessment),console.log(d.data),window.assessment.projects=d.data.assessment.projects?d.data.assessment.projects:window.assessment_project_template,window.assessment.members=d.data.assessment.members,window.assessment.submit=d.data.assessment.submit,window.eval_members=window.assessment.members,t(window.assessment),console.log("login"),console.log(assessment))):a(!1))})}}),h=()=>{u(!0),j()},y=c?e.jsx(k,{color:"inherit"}):e.jsx(ot,{onClick:h});let m;return s?(console.log(o),m=o?e.jsx(rt,{userData:o,isClassStudent:r}):e.jsx(N,{})):m=y,e.jsx(e.Fragment,{children:m})}function ot({onClick:t}){return e.jsx(e.Fragment,{children:e.jsx(C,{title:"登入",children:e.jsx(x,{color:"inherit",onClick:t,children:e.jsx(ne,{})})})})}function rt({userData:t,isClassStudent:s}){const n=t.assessment.members;console.log(s),console.log(t);const o=s?e.jsxs(e.Fragment,{children:[e.jsx(We,{membersAssessment:n}),e.jsx(at,{userData:t})]}):e.jsx(N,{});return e.jsx(e.Fragment,{children:o})}function at({userData:t}){return e.jsx(e.Fragment,{children:e.jsx(E,{alt:t.user,src:t.photo})})}function N(){return e.jsx(e.Fragment,{children:e.jsxs(g,{variant:"h6",component:"div",sx:{flexGrow:1},className:"visitor",children:[e.jsx(se,{}),"訪客"]})})}function it(){const[t,s]=i.useState(null);return e.jsxs(i.Fragment,{children:[e.jsx(oe,{}),e.jsx(re,{children:e.jsxs(D,{sx:{justifyContent:"space-between"},children:[e.jsx(g,{variant:"h6",component:"div",children:"Project Gallery"}),e.jsx(f,{sx:{display:"flex",alignItems:"center"},children:e.jsx(nt,{setAssessment:s})})]})}),e.jsx(D,{id:"back-to-top-anchor"}),e.jsx(ae,{children:e.jsx(f,{sx:{my:2},children:e.jsx(Ye,{assessment:t})})}),e.jsx($,{children:e.jsx(ie,{size:"small","aria-label":"scroll back to top",children:e.jsx(le,{})})})]})}function $(t){const{children:s,window:n}=t,o=ce({target:n?n():void 0,disableHysteresis:!0,threshold:100}),l=r=>{const a=(r.target.ownerDocument||document).querySelector("#back-to-top-anchor");a&&a.scrollIntoView({block:"center"})};return e.jsx(A,{in:o,children:e.jsx(f,{onClick:l,role:"presentation",sx:{position:"fixed",bottom:16,right:16},children:s})})}$.propTypes={children:G.element.isRequired,window:G.func};window.assessment={user:null,group:null,members:null,projects:null,submit:!1};function lt(){return e.jsxs(e.Fragment,{children:[e.jsx(de,{clientId:"235254569809-suckfgfkjcf9p4c04oofodo6ropcj6nf.apps.googleusercontent.com",children:e.jsx(it,{})}),";"]})}X.createRoot(document.getElementById("root")).render(e.jsx(Q.StrictMode,{children:e.jsx(lt,{})}));
